FROM ansibleplaybookbundle/apb-base

LABEL "com.redhat.apb.spec"=\
"dmVyc2lvbjogMS4wCm5hbWU6IHByb3h5LWNvbmZpZwpkZXNjcmlwdGlvbjogUHJvdmlkZXMgcHJv\
eHkgY29uZmlndXJhdGlvbiB0byBjb250YWluZXJzIGFzIGJpbmQgY3JlZGVudGlhbHMuCmJpbmRh\
YmxlOiBUcnVlCmFzeW5jOiBvcHRpb25hbAptZXRhZGF0YToKICBkaXNwbGF5TmFtZTogIlByb3h5\
IENvbmZpZ3VyYXRpb24gKEFQQikiCiAgbG9uZ0Rlc2NyaXB0aW9uOiAiUHJvdmlkZXMgcHJveHkg\
ZW52aXJvbm1lbnQgdmFyaWFibGVzIHRvIGFwcCBjb250YWluZXJzIGFzIGJpbmQgY3JlZGVudGlh\
bHMuIgpwbGFuczoKICAtIG5hbWU6IHBhc3N0aHJvdWdoCiAgICBkZXNjcmlwdGlvbjogQ29waWVz\
IHRoZSBicm9rZXIncyBwcm94eSBjb25maWd1cmF0aW9uIHRvIGEgc2VjcmV0IGFjY2Vzc2libGUg\
dG8gY29udGFpbmVycyBhcyBiaW5kIGNyZWRlbnRpYWxzLgogICAgZnJlZTogVHJ1ZQogICAgbWV0\
YWRhdGE6CiAgICAgIGRpc3BsYXlOYW1lOiBCcm9rZXIgUHJveHkgU2V0dGluZ3MKICAgIHBhcmFt\
ZXRlcnM6IFtdCgogIC0gbmFtZTogY3VzdG9tCiAgICBkZXNjcmlwdGlvbjogUHJvdmlkZXMgY3Vz\
dG9tIHByb3h5IGNvbmZpZ3VyYXRpb24gYXMgYSBzZWNyZXQgYWNjZXNzaWJsZSB0byBjb250YWlu\
ZXJzIGFzIGJpbmQgY3JlZGVudGlhbHMuCiAgICBmcmVlOiBUcnVlCiAgICBtZXRhZGF0YToKICAg\
ICAgZGlzcGxheU5hbWU6IEN1c3RvbSBQcm94eSBTZXR0aW5ncwogICAgcGFyYW1ldGVyczoKICAg\
ICAgLSBuYW1lOiBodHRwX3Byb3h5CiAgICAgICAgdGl0bGU6IEhUVFAgcHJveHkgVVJMCiAgICAg\
ICAgZGVzY3JpcHRpb246ICdVUkwgdG8gcHJveHkgSFRUUCB0cmFmZmljIHRocm91Z2guIFdpbGwg\
YmUgdXNlZCB0byBzZXQgJGh0dHBfcHJveHkgYW5kICRIVFRQX1BST1hZIGVudmlyb25tZW50IHZh\
cmlhYmxlcy4gQ2FuIGJlIHRoZSBzYW1lIGFzIGh0dHBzX3Byb3h5LiBFLmcuICJodHRwOi8vc3F1\
aWQtcHJveHktZXhhbXBsZS5vcmc6MzEyOC8iLiBMZWF2ZSBibGFuayB0byBza2lwIHByb3h5aW5n\
IEhUVFAgdHJhZmZpYy4nCiAgICAgICAgdHlwZTogc3RyaW5nCgogICAgICAtIG5hbWU6IGh0dHBz\
X3Byb3h5CiAgICAgICAgdGl0bGU6IEhUVFBTIHByb3h5IFVSTAogICAgICAgIGRlc2NyaXB0aW9u\
OiAnVVJMIHRvIHByb3h5IEhUVFBTIHRyYWZmaWMgdGhyb3VnaC4gV2lsbCBiZSB1c2VkIHRvIHNl\
dCAkaHR0cHNfcHJveHkgYW5kICRIVFRQU19QUk9YWSBlbnZpcm9ubWVudCB2YXJpYWJsZXMuIENh\
biBiZSB0aGUgc2FtZSBhcyBodHRwX3Byb3h5LiBFLmcuICJodHRwOi8vc3F1aWQtcHJveHktZXhh\
bXBsZS5jb206MzEyOC8iLiBMZWF2ZSBibGFuayB0byBza2lwIHByb3h5aW5nIEhUVFBTIHRyYWZm\
aWMuJwogICAgICAgIHR5cGU6IHN0cmluZwoKICAgICAgLSBuYW1lOiBub19wcm94eQogICAgICAg\
IHRpdGxlOiBObyBwcm94eSBVUkwgbGlzdAogICAgICAgIGRlc2NyaXB0aW9uOiAnU3BlY2lmaWVz\
IFVSTHMgd2hpY2ggc2hvdWxkIGJlIGV4bHVkZWQgZnJvbSBwcm94eWluZyAoc2hvdWxkIGJlIGNv\
bnRhY3RlZCBkaXJlY3RseSkuIENvbW1hIHNlcGFyYXRlZCBtaXggb2YgaG9zdG5hbWVzLCBkb21h\
aW4gbmFtZXMsIG9yIGJvdGguIEUuZy4gIiouZm9vYmFyLmNvbSxob21lLmNvbScKICAgICAgICB0\
eXBlOiBzdHJpbmcK"

COPY playbooks /opt/apb/actions
COPY roles /opt/ansible/roles
RUN chmod -R g=u /opt/{ansible,apb}
USER apb
