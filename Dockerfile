FROM ansibleplaybookbundle/apb-base

LABEL "com.redhat.apb.spec"=\
"dmVyc2lvbjogMS4wCm5hbWU6IHByb3h5LWNvbmZpZwpkZXNjcmlwdGlvbjogUHJvdmlkZXMgcHJv\
eHkgY29uZmlndXJhdGlvbiB0byBjb250YWluZXJzIGFzIGJpbmQgY3JlZGVudGlhbHMuCmJpbmRh\
YmxlOiBUcnVlCmFzeW5jOiBvcHRpb25hbAptZXRhZGF0YToKICBkaXNwbGF5TmFtZTogIlByb3h5\
IENvbmZpZ3VyYXRpb24gKEFQQikiCiAgbG9uZ0Rlc2NyaXB0aW9uOiAiUHJvdmlkZXMgcHJveHkg\
ZW52aXJvbm1lbnQgdmFyaWFibGVzIHRvIGFwcCBjb250YWluZXJzIGFzIGJpbmQgY3JlZGVudGlh\
bHMuIgpwbGFuczoKICAtIG5hbWU6IHBhc3N0aHJvdWdoCiAgICBkZXNjcmlwdGlvbjogQ29waWVz\
IHRoZSBicm9rZXIncyBwcm94eSBjb25maWd1cmF0aW9uIHRvIGEgc2VjcmV0IGFjY2Vzc2libGUg\
dG8gY29udGFpbmVycyBhcyBiaW5kIGNyZWRlbnRpYWxzLgogICAgZnJlZTogVHJ1ZQogICAgbWV0\
YWRhdGE6CiAgICAgIGRpc3BsYXlOYW1lOiBCcm9rZXIgUHJveHkgU2V0dGluZ3MKICAgIHBhcmFt\
ZXRlcnM6CiAgICAgIC0gbmFtZTogYnJva2VyX2h0dHBfcHJveHkKICAgICAgICB0aXRsZTogQ29w\
eSBodHRwX3Byb3h5IGVudmlyb25tZW50IHZhcmlhYmxlIGZyb20gYnJva2VyCiAgICAgICAgZGVz\
Y3JpcHRpb246ICdVbmNoZWNrIHRoaXMgb3B0aW9uIHRvIGxlYXZlIHRoZSBodHRwX3Byb3h5IHZh\
ciBlbXB0eS4nCiAgICAgICAgdHlwZTogYm9vbGVhbgogICAgICAgIGRlZmF1bHQ6IFRydWUKCiAg\
ICAgIC0gbmFtZTogYnJva2VyX2h0dHBzX3Byb3h5CiAgICAgICAgdGl0bGU6IENvcHkgaHR0cHNf\
cHJveHkgZW52aXJvbm1lbnQgdmFyaWFibGUgZnJvbSBicm9rZXIKICAgICAgICBkZXNjcmlwdGlv\
bjogJ1VuY2hlY2sgdGhpcyBvcHRpb24gdG8gbGVhdmUgdGhlIGh0dHBzX3Byb3h5IHZhciBlbXB0\
eS4nCiAgICAgICAgdHlwZTogYm9vbGVhbgogICAgICAgIGRlZmF1bHQ6IFRydWUKCiAgICAgIC0g\
bmFtZTogYnJva2VyX25vX3Byb3h5CiAgICAgICAgdGl0bGU6IENvcHkgbm9fcHJveHkgZW52aXJv\
bm1lbnQgdmFyaWFibGUgZnJvbSBicm9rZXIKICAgICAgICBkZXNjcmlwdGlvbjogJ1VuY2hlY2sg\
dGhpcyBvcHRpb24gdG8gbGVhdmUgdGhlIG5vX3Byb3h5IHZhciBlbXB0eS4nCiAgICAgICAgdHlw\
ZTogYm9vbGVhbgogICAgICAgIGRlZmF1bHQ6IFRydWUKCiAgLSBuYW1lOiBjdXN0b20KICAgIGRl\
c2NyaXB0aW9uOiBQcm92aWRlcyBjdXN0b20gcHJveHkgY29uZmlndXJhdGlvbiBhcyBhIHNlY3Jl\
dCBhY2Nlc3NpYmxlIHRvIGNvbnRhaW5lcnMgYXMgYmluZCBjcmVkZW50aWFscy4KICAgIGZyZWU6\
IFRydWUKICAgIG1ldGFkYXRhOgogICAgICBkaXNwbGF5TmFtZTogQ3VzdG9tIFByb3h5IFNldHRp\
bmdzCiAgICBwYXJhbWV0ZXJzOgogICAgICAtIG5hbWU6IGh0dHBfcHJveHkKICAgICAgICB0aXRs\
ZTogSFRUUCBwcm94eSBVUkwKICAgICAgICBkZXNjcmlwdGlvbjogJ1VSTCB0byBwcm94eSBIVFRQ\
IHRyYWZmaWMgdGhyb3VnaC4gV2lsbCBiZSB1c2VkIHRvIHNldCAkaHR0cF9wcm94eSBhbmQgJEhU\
VFBfUFJPWFkgZW52aXJvbm1lbnQgdmFyaWFibGVzLiBDYW4gYmUgdGhlIHNhbWUgYXMgaHR0cHNf\
cHJveHkuIEUuZy4gImh0dHA6Ly9zcXVpZC1wcm94eS1leGFtcGxlLm9yZzozMTI4LyIuIExlYXZl\
IGJsYW5rIHRvIHNraXAgcHJveHlpbmcgSFRUUCB0cmFmZmljLicKICAgICAgICB0eXBlOiBzdHJp\
bmcKCiAgICAgIC0gbmFtZTogaHR0cHNfcHJveHkKICAgICAgICB0aXRsZTogSFRUUFMgcHJveHkg\
VVJMCiAgICAgICAgZGVzY3JpcHRpb246ICdVUkwgdG8gcHJveHkgSFRUUFMgdHJhZmZpYyB0aHJv\
dWdoLiBXaWxsIGJlIHVzZWQgdG8gc2V0ICRodHRwc19wcm94eSBhbmQgJEhUVFBTX1BST1hZIGVu\
dmlyb25tZW50IHZhcmlhYmxlcy4gQ2FuIGJlIHRoZSBzYW1lIGFzIGh0dHBfcHJveHkuIEUuZy4g\
Imh0dHA6Ly9zcXVpZC1wcm94eS1leGFtcGxlLmNvbTozMTI4LyIuIExlYXZlIGJsYW5rIHRvIHNr\
aXAgcHJveHlpbmcgSFRUUFMgdHJhZmZpYy4nCiAgICAgICAgdHlwZTogc3RyaW5nCgogICAgICAt\
IG5hbWU6IG5vX3Byb3h5CiAgICAgICAgdGl0bGU6IE5vIHByb3h5IFVSTCBsaXN0CiAgICAgICAg\
ZGVzY3JpcHRpb246ICdTcGVjaWZpZXMgVVJMcyB3aGljaCBzaG91bGQgYmUgZXhsdWRlZCBmcm9t\
IHByb3h5aW5nIChzaG91bGQgYmUgY29udGFjdGVkIGRpcmVjdGx5KS4gQ29tbWEgc2VwYXJhdGVk\
IG1peCBvZiBob3N0bmFtZXMsIGRvbWFpbiBuYW1lcywgb3IgYm90aC4gRS5nLiAiKi5mb29iYXIu\
Y29tLGhvbWUuY29tJwogICAgICAgIHR5cGU6IHN0cmluZwoKCg=="

COPY playbooks /opt/apb/actions
COPY roles /opt/ansible/roles
RUN chmod -R g=u /opt/{ansible,apb}
USER apb
