FROM ansibleplaybookbundle/apb-base

LABEL "com.redhat.apb.spec"=\
"dmVyc2lvbjogMS4wCm5hbWU6IHByb3h5LWNvbmZpZy1hcGIKZGVzY3JpcHRpb246IFByb3h5IENv\
bmZpZ3VyYXRpb24KYmluZGFibGU6IFRydWUKYXN5bmM6IG9wdGlvbmFsCm1ldGFkYXRhOgogIGRp\
c3BsYXlOYW1lOiAiUHJveHkgQ29uZmlndXJhdGlvbiAoQVBCKSIKICBsb25nRGVzY3JpcHRpb246\
ICJQcm92aWRlcyBiaW5kIGNyZWRlbnRpYWxzIGFsbG93aW5nIG90aGVyIGNvbnRhaW5lcnMgdG8g\
Y29uc3VtZSBwcm94eSBzZXR0aW5ncy4iCnBsYW5zOgogIC0gbmFtZTogcGFzc3Rocm91Z2gKICAg\
IGRlc2NyaXB0aW9uOiBDb3B5IHRoZSBicm9rZXIncyBwcm94eSBjb25maWd1cmF0aW9uLgogICAg\
ZnJlZTogVHJ1ZQogICAgbWV0YWRhdGE6CiAgICAgIGRpc3BsYXlOYW1lOiBCcm9rZXIgUHJveHkg\
U2V0dGluZ3MKICAgIHBhcmFtZXRlcnM6IFtdCgogIC0gbmFtZTogY3VzdG9tCiAgICBkZXNjcmlw\
dGlvbjogUHJvdmlkZSBjdXN0b20gcHJveHkgY29uZmlndXJhdGlvbi4KICAgIGZyZWU6IFRydWUK\
ICAgIG1ldGFkYXRhOgogICAgICBkaXNwbGF5TmFtZTogQ3VzdG9tIFByb3h5IFNldHRpbmdzCiAg\
ICBwYXJhbWV0ZXJzOgogICAgICAtIG5hbWU6IGh0dHBfcHJveHkKICAgICAgICB0aXRsZTogSFRU\
UCBwcm94eSBVUkwKICAgICAgICBkZXNjcmlwdGlvbjogJ1VSTCB0byBwcm94eSBIVFRQIHRyYWZm\
aWMgdGhyb3VnaC4gV2lsbCBiZSB1c2VkIHRvIHNldCAkaHR0cF9wcm94eSBhbmQgJEhUVFBfUFJP\
WFkgZW52aXJvbm1lbnQgdmFyaWFibGVzLiBDYW4gYmUgdGhlIHNhbWUgYXMgaHR0cHNfcHJveHku\
IEUuZy4gImh0dHA6Ly9zcXVpZC1wcm94eS1leGFtcGxlLm9yZzozMTI4LyIuIExlYXZlIGJsYW5r\
IHRvIHNraXAgcHJveHlpbmcgSFRUUCB0cmFmZmljLicKICAgICAgICB0eXBlOiBzdHJpbmcKCiAg\
ICAgIC0gbmFtZTogaHR0cHNfcHJveHkKICAgICAgICB0aXRsZTogSFRUUFMgcHJveHkgVVJMCiAg\
ICAgICAgZGVzY3JpcHRpb246ICdVUkwgdG8gcHJveHkgSFRUUFMgdHJhZmZpYyB0aHJvdWdoLiBX\
aWxsIGJlIHVzZWQgdG8gc2V0ICRodHRwc19wcm94eSBhbmQgJEhUVFBTX1BST1hZIGVudmlyb25t\
ZW50IHZhcmlhYmxlcy4gQ2FuIGJlIHRoZSBzYW1lIGFzIGh0dHBfcHJveHkuIEUuZy4gImh0dHA6\
Ly9zcXVpZC1wcm94eS1leGFtcGxlLmNvbTozMTI4LyIuIExlYXZlIGJsYW5rIHRvIHNraXAgcHJv\
eHlpbmcgSFRUUFMgdHJhZmZpYy4nCiAgICAgICAgdHlwZTogc3RyaW5nCgogICAgICAtIG5hbWU6\
IG5vX3Byb3h5CiAgICAgICAgdGl0bGU6IE5vIHByb3h5IFVSTCBsaXN0CiAgICAgICAgZGVzY3Jp\
cHRpb246ICdTcGVjaWZpZXMgVVJMcyB3aGljaCBzaG91bGQgYmUgZXhsdWRlZCBmcm9tIHByb3h5\
aW5nIChzaG91bGQgYmUgY29udGFjdGVkIGRpcmVjdGx5KS4gQ29tbWEgc2VwYXJhdGVkIG1peCBv\
ZiBob3N0bmFtZXMsIGRvbWFpbiBuYW1lcywgb3IgYm90aC4gRS5nLiAiKi5mb29iYXIuY29tLGhv\
bWUuY29tJwogICAgICAgIHR5cGU6IHN0cmluZwo="

COPY playbooks /opt/apb/actions
COPY roles /opt/ansible/roles
RUN chmod -R g=u /opt/{ansible,apb}
USER apb
